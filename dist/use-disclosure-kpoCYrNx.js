import e,{useRef as t,useEffect as n,useState as r,useLayoutEffect as o,useCallback as u}from"react";const i=["mousedown","touchstart"];function c(e,r,o){const u=t();return n((()=>{const t=t=>{const{target:n}=null!=t?t:{};if(Array.isArray(o)){const r=(null==n?void 0:n.hasAttribute("data-ignore-outside-clicks"))||!document.body.contains(n)&&"HTML"!==n.tagName;o.every((e=>!!e&&!t.composedPath().includes(e)))&&!r&&e()}else u.current&&!u.current.contains(n)&&e()};return(r||i).forEach((e=>document.addEventListener(e,t))),()=>{(r||i).forEach((e=>document.removeEventListener(e,t)))}}),[u,e,o]),u}function a(e,o,{getInitialValueInEffect:u}={getInitialValueInEffect:!0}){const[i,c]=r(u?o:function(e,t){return"boolean"==typeof t?t:"undefined"!=typeof window&&"matchMedia"in window&&window.matchMedia(e).matches}(e,o)),a=t();return n((()=>{if("matchMedia"in window)return a.current=window.matchMedia(e),c(a.current.matches),function(e,t){try{return e.addEventListener("change",t),()=>e.removeEventListener("change",t)}catch(n){return e.addListener(t),()=>e.removeListener(t)}}(a.current,(e=>c(e.matches)))}),[e]),i}function d(e,t,n){return void 0===t&&void 0===n?e:void 0!==t&&void 0===n?Math.max(e,t):void 0===t&&void 0!==n?Math.min(e,n):Math.min(Math.max(e,t),n)}const s="undefined"!=typeof document?o:n;function l(e,r){const o=t(!1);n((()=>()=>{o.current=!1}),[]),n((()=>{if(o.current)return e();o.current=!0}),r)}function f({opened:e,shouldReturnFocus:n=!0}){const r=t(),o=()=>{var e;r.current&&"focus"in r.current&&"function"==typeof r.current.focus&&(null==(e=r.current)||e.focus({preventScroll:!0}))};return l((()=>{let t=-1;const u=e=>{"Tab"===e.key&&window.clearTimeout(t)};return document.addEventListener("keydown",u),e?r.current=document.activeElement:n&&(t=window.setTimeout(o,10)),()=>{window.clearTimeout(t),document.removeEventListener("keydown",u)}}),[e,n]),o}const m=/input|select|textarea|button|object/,v="a, input, select, textarea, button, object, [tabindex]";function h(e){return"test"!==process.env.NODE_ENV&&"none"===e.style.display}function p(e){let t=e.getAttribute("tabindex");return null===t&&(t=void 0),parseInt(t,10)}function b(e){const t=e.nodeName.toLowerCase(),n=!Number.isNaN(p(e));return(m.test(t)&&!e.disabled||e instanceof HTMLAnchorElement&&e.href||n)&&function(e){if(e.getAttribute("aria-hidden")||e.getAttribute("hidden")||"hidden"===e.getAttribute("type"))return!1;let t=e;for(;t&&t!==document.body&&11!==t.nodeType;){if(h(t))return!1;t=t.parentNode}return!0}(e)}function y(e){const t=p(e);return(Number.isNaN(t)||t>=0)&&b(e)}function g(e){return Array.from(e.querySelectorAll(v)).filter(y)}function w(){return`mantine-${Math.random().toString(36).slice(2,11)}`}function A(e=!0){const r=t(),o=t(null),i=e=>{let t=e.querySelector("[data-autofocus]");if(!t){const n=Array.from(e.querySelectorAll(v));t=n.find(y)||n.find(b)||null,!t&&b(e)&&(t=e)}t?t.focus({preventScroll:!0}):"development"===process.env.NODE_ENV&&console.warn("[@mantine/hooks/use-focus-trap] Failed to find focusable element within provided node",e)},c=u((t=>{e&&(null!==t?(o.current=function(e,t="body > :not(script)"){const n=w(),r=Array.from(document.querySelectorAll(t)).map((t=>{var r;if((null==(r=null==t?void 0:t.shadowRoot)?void 0:r.contains(e))||t.contains(e))return;const o=t.getAttribute("aria-hidden"),u=t.getAttribute("data-hidden"),i=t.getAttribute("data-focus-id");return t.setAttribute("data-focus-id",n),null===o||"false"===o?t.setAttribute("aria-hidden","true"):u||i||t.setAttribute("data-hidden",o),{node:t,ariaHidden:u||null}}));return()=>{r.forEach((e=>{e&&n===e.node.getAttribute("data-focus-id")&&(null===e.ariaHidden?e.node.removeAttribute("aria-hidden"):e.node.setAttribute("aria-hidden",e.ariaHidden),e.node.removeAttribute("data-focus-id"),e.node.removeAttribute("data-hidden"))}))}}(t),r.current!==t&&(t?(setTimeout((()=>{t.getRootNode()?i(t):"development"===process.env.NODE_ENV&&console.warn("[@mantine/hooks/use-focus-trap] Ref node is not part of the dom",t)})),r.current=t):r.current=null)):o.current&&(o.current(),o.current=null))}),[e]);return n((()=>{if(!e)return;r.current&&setTimeout((()=>i(r.current)));const t=e=>{"Tab"===e.key&&r.current&&function(e,t){const n=g(e);if(!n.length)return void t.preventDefault();const r=n[t.shiftKey?0:n.length-1],o=e.getRootNode();let u=r===o.activeElement||e===o.activeElement;const i=o.activeElement;"INPUT"===i.tagName&&"radio"===i.getAttribute("type")&&(u=n.filter((e=>"radio"===e.getAttribute("type")&&e.getAttribute("name")===i.getAttribute("name"))).includes(r));if(!u)return;t.preventDefault();const c=n[t.shiftKey?n.length-1:0];c&&c.focus()}(r.current,e)};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t),o.current&&o.current()}}),[e]),c}const E=e["useId".toString()]||(()=>{});function N(e){const t=function(){const e=E();return e?`mantine-${e.replace(/:/g,"")}`:""}(),[n,o]=r(t);return s((()=>{o(w())}),[]),"string"==typeof e?e:"undefined"==typeof window?t:n}function L(e,t,r){n((()=>(window.addEventListener(e,t,r),()=>window.removeEventListener(e,t,r))),[e,t])}function M(e,t){"function"==typeof e?e(t):"object"==typeof e&&null!==e&&"current"in e&&(e.current=t)}function T(...e){return t=>{e.forEach((e=>M(e,t)))}}function k(...e){return u(T(...e),e)}function S({value:e,defaultValue:t,finalValue:n,onChange:o=(()=>{})}){const[u,i]=r(void 0!==t?t:n);return void 0!==e?[e,o,!0]:[u,e=>{i(e),null==o||o(e)},!1]}function x(e,t){return a("(prefers-reduced-motion: reduce)",e,t)}function I(e=!1,t){const{onOpen:n,onClose:o}=t||{},[i,c]=r(e),a=u((()=>{c((e=>e||(null==n||n(),!0)))}),[n]),d=u((()=>{c((e=>e?(null==o||o(),!1):e))}),[o]),s=u((()=>{i?d():a()}),[d,a,i]);return[i,{open:a,close:d,toggle:s}]}export{f as a,l as b,A as c,N as d,s as e,a as f,M as g,k as h,x as i,S as j,L as k,I as l,T as m,d as n,w as r,c as u};
